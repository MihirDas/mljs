
com=window.com||{};com.marklogic=window.com.marklogic||{};com.marklogic.widgets=window.com.marklogic.widgets||{};com.marklogic.widgets.kratu=function(container){this.container=container;this.errorPublisher=new com.marklogic.events.Publisher();this.results=null;this.facts=null;this.kratu=new Kratu();this.kratu.setRenderElement(document.getElementById(this.container));this.render="content";this._refresh();};com.marklogic.widgets.kratu.prototype.render=function(render){this.render=render;};com.marklogic.widgets.kratu.prototype.updateResults=function(results){if(typeof(results)!="boolean"&&undefined!=results&&null!=results&&undefined!=results.qtext){this.results=results;if("content"==this.render){var content=new Array();for(var i=0;i<this.results.results.length;i++){content.push(JSON.parse(this.results.results[i].content));}
this.kratu.setEntities(content);}else{this.kratu.setEntities(this.results.results);}
this._refresh();}};com.marklogic.widgets.kratu.prototype.updateFacts=function(facts){this.facts=facts;var rows=new Array();for(var r=0,max=facts.results.bindings.length;r<max;r++){var result=facts.results.bindings[r];var res={};for(var b=0,maxb=facts.head.vars.length;b<maxb;b++){var varname=facts.head.vars[b];res[varname]=result[varname].value;}
rows.push(res);}
this.kratu.setEntities(rows);this._refresh();};com.marklogic.widgets.kratu.prototype.addErrorListener=function(fl){this.errorPublisher.subscribe(fl);};com.marklogic.widgets.kratu.prototype.removeErrorListener=function(fl){this.errorPublisher.unsubscribe(fl);};com.marklogic.widgets.kratu.prototype._refresh=function(){if((null==this.results||undefined==this.results||"boolean"==typeof this.results)&&(null==this.facts||undefined==this.facts||"boolean"==typeof this.facts)){return;}
this.kratu.renderReport();};